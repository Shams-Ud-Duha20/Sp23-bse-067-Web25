<section class="container my-5">
    <h1 class="mb-4 text-center">Edit Vehicle: <%= vehicle.name %></h1>

    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-sm rounded-lg">
                <div class="card-body p-4">
                    <!-- Display errors from server-side validation/upload -->
                    <% if (errors && errors.length > 0) { %>
                        <div class="alert alert-danger" role="alert">
                            <ul>
                                <% errors.forEach(error => { %>
                                    <li><%= error %></li>
                                <% }); %>
                            </ul>
                        </div>
                    <% } %>

                    <!-- IMPORTANT: enctype="multipart/form-data" is required for file uploads -->
                    <form action="/admin/vehicles/edit/<%= vehicle._id %>" method="POST" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="name" class="form-label">Vehicle Name</label>
                            <input type="text" class="form-control" id="name" name="name" value="<%= vehicle.name %>" required>
                        </div>
                        <div class="mb-3">
                            <label for="brand" class="form-label">Brand</label>
                            <input type="text" class="form-control" id="brand" name="brand" value="<%= vehicle.brand %>" required>
                        </div>
                        <div class="mb-3">
                            <label for="price" class="form-label">Price ($)</label>
                            <input type="number" step="0.01" class="form-control" id="price" name="price" value="<%= vehicle.price %>" required>
                        </div>
                        <div class="mb-3">
                            <label for="type" class="form-label">Type (e.g., Sedan, SUV, Truck)</label>
                            <input type="text" class="form-control" id="type" name="type" value="<%= vehicle.type %>" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label d-block">Current Image:</label>
                            <img src="<%= vehicle.image %>" alt="<%= vehicle.name %>" style="max-width: 150px; max-height: 150px; object-fit: cover; border-radius: 8px; margin-bottom: 10px;">
                            <input type="hidden" name="currentImage" value="<%= vehicle.image %>"> {/* Hidden field to retain old image path if no new upload */}
                        </div>
                        <div class="mb-3">
                            <label for="image" class="form-label">Change Image (Optional)</label>
                            <input type="file" class="form-control" id="image" name="image" accept="image/*">
                            <small class="form-text text-muted">Upload a new JPG, PNG, or GIF image to replace the current one.</small>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg rounded-pill">Update Vehicle</button>
                            <a href="/admin/vehicles" class="btn btn-outline-secondary rounded-pill">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
